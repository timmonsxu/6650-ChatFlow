package com.chatflow.client.model;

import com.google.gson.Gson;
import java.time.Instant;

public class ChatMessage {
    private static final Gson GSON = new Gson();

    private final String userId;
    private final String username;
    private final String message;
    private final String timestamp;
    private final String messageType;
    private final int roomId;

    public ChatMessage(String userId, String username, String message,
                       String messageType, int roomId) {
        this.userId = userId;
        this.username = username;
        this.message = message;
        this.timestamp = Instant.now().toString();
        this.messageType = messageType;
        this.roomId = roomId;
    }

    public String toJson() {
        return GSON.toJson(new JsonPayload(userId, username, message, timestamp, messageType));
    }

    public int getRoomId() { return roomId; }
    public String getMessageType() { return messageType; }

    private static class JsonPayload {
        final String userId;
        final String username;
        final String message;
        final String timestamp;
        final String messageType;

        JsonPayload(String userId, String username, String message,
                    String timestamp, String messageType) {
            this.userId = userId;
            this.username = username;
            this.message = message;
            this.timestamp = timestamp;
            this.messageType = messageType;
        }
    }
}
